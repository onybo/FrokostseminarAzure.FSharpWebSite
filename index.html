<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>F# in Azure</title>
    <meta name="description" content="How to use F# to create azure websites and use Azure .NET SDK from F#">
    <meta name="author" content="Olav Nybø">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="//code.jquery.com/jquery-1.8.0.js"></script>
    <script src="//code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">
    <link type="text/css" rel="stylesheet" href="fsharp.formatting/styles/style.css" />
    <link type="text/css" rel="stylesheet" href="fsharp.formatting/styles/deedle.css" />
    <script src="fsharp.formatting/styles/tips.js" type="text/javascript"></script>
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">
    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
    </script>
    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>
<body>
    <div class="reveal">
        <div class="tip" id="fs1">type Person =<br />&#160;&#160;{First: string;<br />&#160;&#160;&#160;Last: string;}<br /><br />Full name: Document.Person</div>
<div class="tip" id="fs2">Person.First: string</div>
<div class="tip" id="fs3">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />Full name: Microsoft.FSharp.Core.Operators.string<br /><br />--------------------<br />type string = System.String<br /><br />Full name: Microsoft.FSharp.Core.string</div>
<div class="tip" id="fs4">Person.Last: string</div>
<div class="tip" id="fs5">type Employee =<br />&#160;&#160;| Worker of Person<br />&#160;&#160;| Manager of Employee list<br /><br />Full name: Document.Employee</div>
<div class="tip" id="fs6">union case Employee.Worker: Person -&gt; Employee</div>
<div class="tip" id="fs7">union case Employee.Manager: Employee list -&gt; Employee</div>
<div class="tip" id="fs8">type &#39;T list = List&lt;&#39;T&gt;<br /><br />Full name: Microsoft.FSharp.Collections.list&lt;_&gt;</div>
<div class="tip" id="fs9">val jdoe : Person<br /><br />Full name: Document.jdoe</div>
<div class="tip" id="fs10">val worker : Employee<br /><br />Full name: Document.worker</div>
<div class="tip" id="fs11">val ignore : value:&#39;T -&gt; unit<br /><br />Full name: Microsoft.FSharp.Core.Operators.ignore</div>

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
            <section >

<section >

<h2>Azure Websites</h2>

<p><img src="images/heart.svg" alt="love" /></p>

<h1>F#</h1>

</section>

</section>

<section >

<p><img src="images/azure_websites.png" alt="azure websites" /></p>

</section>

<section >

<ul>
<li>Hvorfor F#</li>
<li>Basic F# Azure Web Site</li>
<li>Azure DocumentDB</li>
<li>Railway Oriented Programming</li>
<li>Azure Web Site med DocumentDB i F# og Chessie</li>
<li>DocumentDB TypeProvider</li>
</ul>

</section>

<section >

<section >

<h3>Olav Nybø</h3>

<ul>
<li>Twitter; @onybo</li>
<li>Mail: olav.nybo@novanet.no</li>
<li>Dagtid: C# og  TypeScript hos If</li>
<li>Kveldstid: F#</li>
</ul>

</section>

</section>

<section >

<section >

<h3>MVC / Web API</h3>

<table class="pre"><tr><td><pre lang="cs">[RoutePrefix(<span class="s">"persons"</span>)]
<span class="k">public</span> <span class="k">class</span> PersonsController <span class="o">:</span> Controller
{
  <span class="k">private</span> <span class="k">readonly</span> IPersonRepository _personRepository;

  <span class="k">public</span> PersonsController(IPersonRepository personRepository)
  {
    _personRepository <span class="o">=</span> personRepository;
  }

  <span class="c">// eg.: /persons</span>
  [Route]
  <span class="k">public</span> ActionResult Index()
  {
    <span class="k">var</span> persons <span class="o">=</span> _personsRepository.GetPersons();
    <span class="k">return</span> View(persons);
  }

  <span class="c">// eg.: /persons/5</span>
  [Route(<span class="s">"{personId}"</span>)]
  <span class="k">public</span> ActionResult Show(<span class="k">int</span> personId) { <span class="o">.</span><span class="o">.</span><span class="o">.</span> }
}</pre></td></tr></table>

</section>

<section >

<h3>SOLID</h3>

<h4>Interface Segregation Principle</h4>

<h4>Single Responsibility</h4>

<table class="pre"><tr><td><pre lang="cs"><span class="k">public</span> <span class="k">interface</span> IPersonRepository
{
  IEnumerable&lt;Person&gt; GetPersons();
  <span class="k">void</span> SaveChanges();
  <span class="k">void</span> UpdatePerson(Person person);
  <span class="k">void</span> DeletePerson(Person person);
  <span class="o">.</span><span class="o">.</span><span class="o">.</span>
}</pre></td></tr></table>

</section>

<section >

<table class="pre"><tr><td><pre lang="cs"><span class="k">public</span> PersonsWithQuery
{
  <span class="k">public</span> PersonsQuery(DbContext context)
  {
    <span class="o">.</span><span class="o">.</span><span class="o">.</span>
  }

  <span class="k">public</span> IEnumerable&lt;Person&gt; GetPersons()
  {
     <span class="k">from</span> dbContext <span class="k">where</span> bla bla bla.<span class="o">.</span><span class="o">.</span><span class="o">.</span>
  }
}</pre></td></tr></table>

</section>

</section>

<section >

<section >

<h3>Hvorfor F#?</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="c">// simple types in one line</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">Person</span> <span class="o">=</span> {<span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">First</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">string</span>; <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">Last</span><span class="o">:</span><span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="i">string</span>}

<span class="c">// complex types in a few lines</span>
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs5', 6)" onmouseover="showTip(event, 'fs5', 6)" class="i">Employee</span> <span class="o">=</span>
  | <span onmouseout="hideTip(event, 'fs6', 7)" onmouseover="showTip(event, 'fs6', 7)" class="i">Worker</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs1', 8)" onmouseover="showTip(event, 'fs1', 8)" class="i">Person</span>
  | <span onmouseout="hideTip(event, 'fs7', 9)" onmouseover="showTip(event, 'fs7', 9)" class="i">Manager</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs5', 10)" onmouseover="showTip(event, 'fs5', 10)" class="i">Employee</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="i">list</span>

<span class="c">// type inference</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">jdoe</span> <span class="o">=</span> {<span class="i">First</span><span class="o">=</span><span class="s">&quot;</span><span class="s">John</span><span class="s">&quot;</span>;<span class="i">Last</span><span class="o">=</span><span class="s">&quot;</span><span class="s">Doe</span><span class="s">&quot;</span>}
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="i">worker</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 14)" onmouseover="showTip(event, 'fs6', 14)" class="i">Worker</span> <span onmouseout="hideTip(event, 'fs9', 15)" onmouseover="showTip(event, 'fs9', 15)" class="i">jdoe</span></pre>
</td>
</tr>
</table>

</section>

</section>

<section >

<section >

<p><img src="images/null_reference.png" alt="null reference" /></p>

</section>

<section >

<p><img src="images/yoda.gif" alt="null reference" /></p>

</section>

</section>

<section >

<section >

<h1>DEMO</h1>

<ul>
<li>C# web project med F# controllers</li>
<li>F# MVC 5 / F# Web Item Templates</li>
<li>ASP.NET 5 project</li>
</ul>

</section>

</section>

<section >

<section >

<h3>Azure DocumentDb</h3>

<ul>
<li>NoSql Database</li>
<li>SQL</li>
<li>JSON dokumenter</li>
</ul>

</section>

</section>

<section >

<section >

<h3>Azure DocumentDb struktur</h3>

<p><img src="images/DocumentDb_Structure.png" alt="DocumentDb" /></p>

</section>

</section>

<section >

<section >

<h2>DEMO</h2>

<h3><a href="https://portal.azure.com">Azure portal</a></h3>

<ul>
<li>Create database</li>
<li>URI and Keys</li>
<li>Document Explorer</li>
<li>Query Explorer</li>
</ul>

</section>

</section>

<section >

<section >

<h3>Azure SDKs</h3>

<p><img src="images/Microsoft_.NET_Framework_v4.5_logo.png" alt=".NET" />
<img src="images/python-logo-generic.svg" alt="python" />
<img src="images/Unofficial_JavaScript_logo_2.svg.png" alt="JS Client" />
<img src="images/java-logo.jpg" alt="Java" />
<img src="images/nodejs.png" alt="Node" /></p>

</section>

</section>

<section >

<p><img src="images/railway.png" alt="null reference" /></p>

</section>

<section >

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
<span class="l">16: </span>
<span class="l">17: </span>
<span class="l">18: </span>
<span class="l">19: </span>
<span class="l">20: </span>
<span class="l">21: </span>
<span class="l">22: </span>
<span class="l">23: </span>
<span class="l">24: </span>
<span class="l">25: </span>
<span class="l">26: </span>
<span class="l">27: </span>
<span class="l">28: </span>
<span class="l">29: </span>
<span class="l">30: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">public</span> <span class="k">class</span> <span class="i">DocumentsFetcher</span>
{
    <span class="k">private</span> <span class="k">static</span> <span onmouseout="hideTip(event, 'fs3', 16)" onmouseover="showTip(event, 'fs3', 16)" class="i">string</span> <span class="i">EndpointUrl</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">your</span><span class="s"> </span><span class="s">endpoint</span><span class="s"> </span><span class="s">URI</span><span class="s">&gt;</span><span class="s">&quot;</span>;
    <span class="k">private</span> <span class="k">static</span> <span onmouseout="hideTip(event, 'fs3', 17)" onmouseover="showTip(event, 'fs3', 17)" class="i">string</span> <span class="i">AuthorizationKey</span> <span class="o">=</span> <span class="s">&quot;</span><span class="s">&lt;</span><span class="s">your</span><span class="s"> </span><span class="s">key</span><span class="s">&gt;</span><span class="s">&quot;</span>;

    <span class="k">public</span> <span class="i">IEnumerable</span><span class="o">&lt;</span><span class="i">Document</span><span class="o">&gt;</span> <span class="i">GetDocuments</span>()
    {
        <span class="i">var</span> <span class="i">client</span> <span class="o">=</span> <span class="k">new</span> <span class="i">DocumentClient</span>(<span class="k">new</span> <span class="i">Uri</span>(<span class="i">EndpointUrl</span>), <span class="i">AuthorizationKey</span>);
        <span class="i">var</span> <span class="i">database</span> <span class="o">=</span> <span class="i">client</span><span class="o">.</span><span class="i">CreateDatabaseQuery</span>()
                             <span class="o">.</span><span class="i">Where</span>(<span class="i">db</span> <span class="o">=&gt;</span> <span class="i">db</span><span class="o">.</span><span class="i">Id</span> <span class="o">==</span> <span class="s">&quot;</span><span class="s">OlavsDemoDB</span><span class="s">&quot;</span>)
                             <span class="o">.</span><span class="i">AsEnumerable</span>()
                             <span class="o">.</span><span class="i">FirstOrDefault</span>();

        <span class="k">if</span> (<span class="i">database</span> <span class="o">==</span> <span class="k">null</span>)
        {
           <span class="k">return</span> <span class="i">Enumerable</span><span class="o">.</span><span class="i">Empty</span><span class="o">&lt;</span><span class="i">Document</span><span class="o">&gt;</span>();
        }

        <span class="i">var</span> <span class="i">collection</span> <span class="o">=</span> <span class="i">client</span>
                         <span class="o">.</span><span class="i">CreateDocumentCollectionQuery</span>(<span class="i">database</span><span class="o">.</span><span class="i">SelfLink</span>)
                         <span class="o">.</span><span class="i">Where</span>(<span class="i">c</span> <span class="o">=&gt;</span> <span class="i">c</span><span class="o">.</span><span class="i">Id</span> <span class="o">==</span> <span class="s">&quot;</span><span class="s">Persons</span><span class="s">&quot;</span>)
                         <span class="o">.</span><span class="i">ToArray</span>()
                         <span class="o">.</span><span class="i">FirstOrDefault</span>();

        <span class="k">return</span> <span class="i">client</span>
               <span class="o">.</span><span class="i">CreateDocumentQuery</span><span class="o">&lt;</span><span class="i">Document</span><span class="o">&gt;</span>
                         (<span class="i">documentCollection</span><span class="o">.</span><span class="i">DocumentsLink</span>)
               <span class="o">.</span><span class="i">ToList</span>();
    }
}</pre>
</td>
</tr>
</table>

</section>

<section >

<section >

<h3>F# Pipelines</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="i">getDocumentClient</span> <span class="i">uri</span> <span class="i">password</span>
<span class="o">|&gt;</span> <span class="i">getDatabase</span> <span class="s">&quot;</span><span class="s">OlavsDemoDb</span><span class="s">&quot;</span>
<span class="o">|&gt;</span> <span class="i">getCollection</span> <span class="s">&quot;</span><span class="s">Persons</span><span class="s">&quot;</span>
<span class="o">|&gt;</span> <span class="i">getDocuments</span></pre>
</td>
</tr>
</table>

</section>

<section >

<p>Railway oriented programming</p>

<p><img src="images/railway.png" alt="null reference" /></p>

</section>

<section >

<h3>Chessie</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span class="i">Result</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">TSuccess</span>, <span class="o">&#39;</span><span class="i">TMessage</span><span class="o">&gt;</span> <span class="o">=</span>
| <span class="i">Ok</span> <span class="k">of</span> <span class="o">&#39;</span><span class="i">TSuccess</span> <span class="o">*</span> <span class="o">&#39;</span><span class="i">TMessage</span> <span onmouseout="hideTip(event, 'fs8', 18)" onmouseover="showTip(event, 'fs8', 18)" class="i">list</span>
| <span class="i">Fail</span> <span class="k">of</span> <span class="o">&#39;</span><span class="i">TMessage</span> <span onmouseout="hideTip(event, 'fs8', 19)" onmouseover="showTip(event, 'fs8', 19)" class="i">list</span></pre>
</td>
</tr>
</table>

</section>

<section >

<p><img src="images/Railway_chessie.png" alt="railway chessie" /></p>

</section>

<section >

<p><img src="images/Railway_chessie_bind.png" alt="railway chessie bind" /></p>

</section>

<section >

<h3>Railways</h3>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">use</span> <span class="i">client</span> <span class="o">=</span> <span class="k">new</span> <span class="i">DocumentClient</span>(<span class="i">uri</span>, <span class="i">password</span>)
<span class="i">client</span>
<span class="o">|&gt;</span> <span class="i">getDatabase</span> <span class="s">&quot;</span><span class="s">OlavsDemoDb</span><span class="s">&quot;</span>
<span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span> <span class="i">getOrCreateCollectionSync</span> <span class="i">client</span>
<span class="o">&gt;</span><span class="o">&gt;</span><span class="o">=</span> <span class="i">getDocuments</span> <span class="i">client</span>
<span class="o">|&gt;</span> <span class="i">either</span> <span class="i">showDocuments</span> <span class="i">showErrorMessages</span>
<span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs11', 20)" onmouseover="showTip(event, 'fs11', 20)" class="i">ignore</span></pre>
</td>
</tr>
</table>

</section>

</section>

<section >

<h1>DEMO</h1>

</section>

<section >

<section >

<h1>?</h1>

<div style="font-size: 20px">

<ul>
<li>Azure portal: <a href="https://portal.azure.com"><a href="https://portal.azure.com">https://portal.azure.com</a></a></li>
<li>Azure DocumentDb: <a href="http://azure.microsoft.com/en-us/documentation/services/documentdb/"><a href="http://azure.microsoft.com/en-us/documentation/services/documentdb/">http://azure.microsoft.com/en-us/documentation/services/documentdb/</a></a></li>
<li>Info om Railway Oriented Programming: <a href="http://fsharpforfunandprofit.com/posts/recipe-part2/"><a href="http://fsharpforfunandprofit.com/posts/recipe-part2/">http://fsharpforfunandprofit.com/posts/recipe-part2/</a></a> og <a href="http://vimeo.com/97344498">video her</a></li>
<li>Chessie - ett F# bibliotek for ROP: <a href="http://fsprojects.github.io/Chessie/reference/chessie-rop.html"><a href="http://fsprojects.github.io/Chessie/reference/chessie-rop.html">http://fsprojects.github.io/Chessie/reference/chessie-rop.html</a></a></li>
<li>Gratis online kurs i F#: <a href="http://www.tryfsharp.org/Learn"><a href="http://www.tryfsharp.org/Learn">http://www.tryfsharp.org/Learn</a></a></li>
</ul>

</div>

</section>

</section>



        </div>
    </div>
    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>
    <script>

        // Full list of configuration options available here:
        // https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,

            theme: 'sky', // available themes are in /css/theme
            transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

            // Parallax scrolling
            // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
            // parallaxBackgroundSize: '2100px 900px',

            // Optional libraries used to extend on reveal.js
            dependencies: [
                { src: 'lib/js/classList.js', condition: function () { return !document.body.classList; } },
                { src: 'plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
                { src: 'plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } },
                { src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } },
                { src: 'plugin/zoom-js/zoom.js', async: true, condition: function () { return !!document.body.classList; } },
                { src: 'plugin/notes/notes.js', async: true, condition: function () { return !!document.body.classList; } }
            ]
        });

    </script>
</body>
</html>

